<?php

/*
 * Bear CMS addon for Bear Framework
 * https://bearcms.com/
 * Copyright (c) Amplilabs Ltd.
 * Free to use under the MIT license.
 */

return <<<'EOT'
var bearCMS=bearCMS||{};bearCMS.sliderElements=bearCMS.sliderElements||function(){var e=[],t=[],r=function(e,r,n){for(var a=!1,i=0;i<t.length;i++){var o=t[i];if(o[0]===e){o[1][r]=n,a=!0;break}}if(!a){var l={};l[r]=n,t.push([e,l])}},n=function(e,r){for(var n=0;n<t.length;n++){var a=t[n];if(a[0]===e)return void 0!==a[1][r]?a[1][r]:null}return null},a=function(e){return e.querySelector("[data-bearcms-slider-button-previous]")},i=function(e){return e.querySelector("[data-bearcms-slider-button-next]")},o=function(e,t){t?e.setAttribute("data-bearcms-slider-button-visible","1"):e.removeAttribute("data-bearcms-slider-button-visible")},l=function(e){return"1"===e.getAttribute("data-rvr-editable")},u=function(e,t){if(null!==t&&null!==e)for(var r=t.parentNode;null!==r;){if(r===e)return!0;r=r.parentNode}return!1},d=function(e){for(var t=[],r=l(e),n=e.firstChild.childNodes,a=0;a<n.length;a++){var i=n[a];(r||0!==i.childNodes.length)&&t.push(i)}return t},s=function(e){var t=e.querySelector("[data-bearcms-slider-indicators]"),r=d(e).length,n="";if(r>1)for(var a=0;a<r;a++)n+="<span data-bearcms-slider-indicator></span>";if(t.innerHTML=n,r>1)for(a=0;a<r;a++)!function(r){t.childNodes[r].addEventListener("click",(function(){h(e,r)}))}(a)},c=function(e){for(var t=n(e,"index"),r=e.querySelector("[data-bearcms-slider-indicators]").childNodes,a=0;a<r.length;a++)if(void 0!==r[a]){var i=r[a];a===t?i.setAttribute("data-bearcms-slider-indicator-selected",""):i.removeAttribute("data-bearcms-slider-indicator-selected")}},f=function(e){var t=e.getAttribute("data-bearcms-slider-direction"),f=e.getAttribute("data-bearcms-slider-autoplay");if(l(e)){var b=e.firstChild.childNodes,p=b[b.length-1];p.childNodes.length>0&&(p.parentNode.insertAdjacentHTML("beforeend","<div></div>"),s(e))}var h,g=d(e),S=g.length,x=n(e,"index"),A=a(e),N=i(e);o(A,x>0),o(N,x+1<S);for(var w=0;w<S;w++){var C=g[w],E="0",L="0",P="1",I=!0;"horizontal"===t?(x>0&&(E="-"+100*x+"%"),w!==x&&(I=!1)):"vertical"===t?(w>0&&(E="-"+100*w+"%"),L=100*(w-x)+"%",w!==x&&(I=!1)):"swap"===t&&(w>0&&(E="-"+100*w+"%"),w!==x&&(P="0",I=!1)),C.style.setProperty("transform","translateX("+E+") translateY("+L+")"),C.style.setProperty("opacity",P),C.style.setProperty("pointer-events",I?"all":"none")}if(n(e,"autoplayValue")!==f&&(m(e),r(e,"autoplayValue",f),null!==f)){var M=(h=f).indexOf("ms")?1e3*parseInt(h.replace("ms","")):h.indexOf("s")?1e3*parseInt(h.replace("s",""))*1e3:null;if(null!==M){var q=window.setInterval((function(){v(e)||function(e){var t=e.getBoundingClientRect();if(0===t.width&&0===t.height)return!1;for(var r=getComputedStyle(e),n=function(e){return parseInt(r.getPropertyValue("border-"+e+"-width").replace("px",""))},a=t.left+1+n("left"),i=t.right-1+n("right"),o=t.top+1+n("top"),l=t.bottom-1+n("bottom"),d=[[a,o],[i,o],[a,l],[i,l]],s=0;s<d.length;s++){var c=d[s],f=document.elementFromPoint(c[0],c[1]);if(f===e||u(e,f))return!0}return!1}(e)&&y(e,1)}),M);r(e,"autoplayInterval",q)}}c(e)},v=function(e){return null!==n(e,"autoplayPaused")},b=function(e){r(e,"autoplayPaused",1)},p=function(e){r(e,"autoplayPaused",null)},m=function(e){window.clearInterval(n(e,"autoplayInterval"))},h=function(e,t){r(e,"index",t),f(e)},y=function(e,t){var r=n(e,"index");r+=t;var a=d(e).length;r<0?r=0:r>a-1&&(r=a-1),h(e,r)},g=function(t){if(void 0!==t)var n=[t];else n=document.querySelectorAll(".bearcms-slider-element");for(var o=0;o<n.length;o++){t=n[o];-1===e.indexOf(t)&&(!function(e){var t=a(e),n=i(e);t.addEventListener("click",(function(){y(e,-1)})),n.addEventListener("click",(function(){y(e,1)})),e.addEventListener("mouseenter",(function(){b(e)})),e.addEventListener("mouseleave",(function(){p(e)})),r(e,"index",0),s(e),c(e),new MutationObserver((function(){f(e),s(e),c(e)})).observe(e,{attributeFilter:["data-rvr-editable"]})}(t),e.push(t)),f(t)}};return document.addEventListener("readystatechange",(function(){g()})),"complete"===document.readyState&&g(),{update:g}}();
EOT;
