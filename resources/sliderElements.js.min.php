<?php

/*
 * Bear CMS addon for Bear Framework
 * https://bearcms.com/
 * Copyright (c) Amplilabs Ltd.
 * Free to use under the MIT license.
 */

return <<<'EOT'
var bearCMS=bearCMS||{};bearCMS.sliderElements=bearCMS.sliderElements||function(){var e=ivoPetkov.bearFrameworkAddons.touchEvents,t=[],r=[],i=function(e,t,i){for(var n=!1,a=0;a<r.length;a++){var o=r[a];if(o[0]===e){o[1][t]=i,n=!0;break}}if(!n){var l={};l[t]=i,r.push([e,l])}},n=function(e,t){for(var i=0;i<r.length;i++){var n=r[i];if(n[0]===e)return void 0!==n[1][t]?n[1][t]:null}return null},a=function(e){return e.querySelector("[data-bearcms-slider-button-previous]")},o=function(e){return e.querySelector("[data-bearcms-slider-button-next]")},l=function(e,t){t?e.setAttribute("data-bearcms-slider-button-visible","1"):e.removeAttribute("data-bearcms-slider-button-visible")},d=function(e,t){t?e.removeAttribute("data-bearcms-slider-no-transition"):e.setAttribute("data-bearcms-slider-no-transition","")},s=function(e){return"1"===e.getAttribute("data-rvr-editable")},u=function(e,t){if(null!==t&&null!==e)for(var r=t.parentNode;null!==r;){if(r===e)return!0;r=r.parentNode}return!1},c=function(e){var t=e.getBoundingClientRect();return{width:t.width,height:t.height}},f=function(e){for(var t=[],r=s(e),i=e.firstChild.childNodes,n=0;n<i.length;n++){var a=i[n];(r||0!==a.childNodes.length)&&t.push(a)}return t},v=function(e){var t=e.querySelector("[data-bearcms-slider-indicators]"),r=f(e).length,i="";if(r>1)for(var n=0;n<r;n++)i+="<span data-bearcms-slider-indicator></span>";if(t.innerHTML=i,r>1)for(n=0;n<r;n++)!function(r){t.childNodes[r].addEventListener("click",(function(){x(e,r)}))}(n)},h=function(e){for(var t=n(e,"index"),r=e.querySelector("[data-bearcms-slider-indicators]").childNodes,i=0;i<r.length;i++)if(void 0!==r[i]){var a=r[i];i===t?a.setAttribute("data-bearcms-slider-indicator-selected",""):a.removeAttribute("data-bearcms-slider-indicator-selected")}},b=function(e){var t=e.getAttribute("data-bearcms-slider-direction"),r=e.getAttribute("data-bearcms-slider-autoplay");if(s(e)){var d=e.firstChild.childNodes,b=d.length,g=d[b-1];g.childNodes.length>0&&(g.parentNode.insertAdjacentHTML("beforeend","<div></div>"),v(e));for(var m=function(){var t=e.firstChild.childNodes,r=t.length;if(r>=2){var i=t[r-1],n=t[r-2];if(0===i.childNodes.length&&0===n.childNodes.length)return i.parentNode.removeChild(i),v(e),!0}return!1},x=0;x<b&&m();x++);}var A=f(e),C=A.length,N=n(e,"index"),E=a(e),S=o(e);l(E,N>0),l(S,N+1<C);var L,P=0,M=0,k=[0];if(("horizontal"===t||"vertical"===t)&&C>0){var I=0,z=0,q=c(e.firstChild);for(x=0;x<C;x++){var O=A[x],F=c(O);if(x<N&&(P+=F.width,M+=F.height),x>0)for(var V=x;V<C;V++)void 0===k[V]&&(k[V]=0),k[V]+=F.height;I+=F.width,z+=F.height}var B=q.width,H=q.height;B+P>I&&(P+=I-(B+P)),H+M>z&&(M+=z-(H+M))}for(x=0;x<C;x++){O=A[x],F=c(O);var R="0px",T="0px",X="1";"horizontal"===t?(N>0&&(R="-"+P+"px"),x!==N&&!1):"vertical"===t?(N>0&&(T="-"+M+"px"),x!==N&&!1):"swap"===t&&(x>0&&(R="-"+100*x+"%"),x!==N&&(X="0",!1)),O.style.setProperty("--bse-slide-x",R),O.style.setProperty("--bse-slide-y",T),O.style.setProperty("opacity",X)}if(n(e,"autoplayValue")!==r&&(y(e),i(e,"autoplayValue",r),null!==r)){var Y=(L=r).indexOf("ms")?1e3*parseInt(L.replace("ms","")):L.indexOf("s")?1e3*parseInt(L.replace("s",""))*1e3:null;if(null!==Y){var j=window.setInterval((function(){p(e)||function(e){var t=e.getBoundingClientRect();if(0===t.width&&0===t.height)return!1;for(var r=getComputedStyle(e),i=function(e){return parseInt(r.getPropertyValue("border-"+e+"-width").replace("px",""))},n=t.left+1+i("left"),a=t.right-1+i("right"),o=t.top+1+i("top"),l=t.bottom-1+i("bottom"),d=[[n,o],[a,o],[n,l],[a,l]],s=0;s<d.length;s++){var c=d[s],f=document.elementFromPoint(c[0],c[1]);if(f===e||u(e,f))return!0}return!1}(e)&&w(e,1)}),Y);i(e,"autoplayInterval",j)}}h(e)},p=function(e){return null!==n(e,"autoplayPaused")},g=function(e){i(e,"autoplayPaused",1)},m=function(e){i(e,"autoplayPaused",null)},y=function(e){window.clearInterval(n(e,"autoplayInterval"))},x=function(e,t){i(e,"index",t),b(e)},w=function(e,t){if(0!==t){var r=n(e,"index");r+=t;var i=f(e).length;r<0?r=0:r>i-1&&(r=i-1),x(e,r)}},A=function(e,t,r){e.style.setProperty("--bse-swipe-x",t),e.style.setProperty("--bse-swipe-y",r)},C=function(r){if(void 0!==r)var l=[r];else l=document.querySelectorAll(".bearcms-slider-element");for(var s=0;s<l.length;s++){r=l[s];-1===t.indexOf(r)&&(!function(t){var r=a(t),l=o(t);r.addEventListener("click",(function(){w(t,-1)})),l.addEventListener("click",(function(){w(t,1)})),t.addEventListener("mouseenter",(function(){g(t)})),t.addEventListener("mouseleave",(function(){m(t)})),i(t,"index",0),v(t),h(t),new MutationObserver((function(){b(t),v(t),h(t)})).observe(t,{attributeFilter:["data-rvr-editable"]});var s=e.addSwipe(t.firstChild,t.ownerDocument.body);s.addEventListener("start",(function(e){if(A(t,"0px","0px"),null!==t.getAttribute("data-bearcms-slider-swipe")){var r=t.getAttribute("data-bearcms-slider-direction");"horizontal"!==r&&"vertical"!==r||d(t,!1)}})),s.addEventListener("change",(function(e){if(null!==t.getAttribute("data-bearcms-slider-swipe")){var r=t.getAttribute("data-bearcms-slider-direction");"horizontal"===r?A(t,e.changeX+"px","0px"):"vertical"===r&&A(t,"0px",e.changeY+"px")}})),s.addEventListener("end",(function(e){if(null!==t.getAttribute("data-bearcms-slider-swipe")){d(t,!0),A(t,"0px","0px");var r=t.getAttribute("data-bearcms-slider-direction"),i=null;if("horizontal"===r||"swap"===r?i=e.changeX:"vertical"===r&&(i=e.changeY),null!==i){var a=Math.abs(i);if(a>40){var o=i<0;if("swap"===r)w(t,o?1:-1);else{var l=n(t,"index"),s=f(t),u=s.length,v=0,h=null,b=[];if(o)for(var p=l;p<u;p++)b.push(p);else for(p=l;p>=0;p--)b.push(p);for(p=0;p<b.length;p++){var g=b[p],m=s[g],y=c(m),x="horizontal"===r?y.width:y.height;if(v+(o?0:x)>=a){h=g+(o?0:-1);break}v+=x}null===h&&(h=o?u-1:0),w(t,h-l)}}}}})),d(t,!0)}(r),t.push(r)),b(r)}};return document.addEventListener("readystatechange",(function(){C()})),"complete"===document.readyState&&C(),{update:C}}();
EOT;